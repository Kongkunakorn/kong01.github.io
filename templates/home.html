{% extends "base.html" %}

{% block title %}Typing Menu{% endblock %}

{% block content %}
<a class="center TypingMenu">TypingMenu</a>
<div id="category-list-container" style="max-width: 500px; margin: auto">
  {% for key, icon in categories.items() %}
  <button type="button" class="category-button modal-trigger" data-target="wordModal"
    onclick="selectCategory('{{ key }}', '{{ category_sizes[key] }}')">
    <span>{{ icon }} {{ key|capitalize }}</span>
    <span style="font-size: 14px; color: #cccccc">
      {{ category_sizes[key] }} คำ
    </span>
  </button>
  {% endfor %}
</div>

<!-- Modal สำหรับเลือกจำนวนคำ -->
<div id="wordModal" class="modal">
  <div class="modal-content">
    <h5>เลือกจำนวนคำที่จะเล่น</h5>
    <form id="wordForm" method="get">
      <input type="hidden" name="category" id="categoryInput" />
      <div class="input-field">
        <input type="number" id="max_words" name="max_words" min="1" value="10" />
        <label for="max_words">จำนวนคำ</label>
      </div>
      <button type="submit" class="btn waves-effect waves-light">เริ่มเล่น</button>
    </form>
  </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
  document.addEventListener('DOMContentLoaded', function () {
    var elems = document.querySelectorAll('.modal');
    M.Modal.init(elems);
  });

  function selectCategory(category, maxCount) {
    document.getElementById('categoryInput').value = category;
    document.getElementById('max_words').max = parseInt(maxCount, 10);
    document.getElementById('wordForm').action = "/play/" + category;
  }
</script>
{% endblock %}